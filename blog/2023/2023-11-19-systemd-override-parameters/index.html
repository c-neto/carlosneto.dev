
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Properties Overriding: A Smart Way to Customize Systemd Unit Properties" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://carlosneto.dev/blog/2023/2023-11-19-systemd-override-parameters/" />
<meta property="og:site_name" content="Carlos Neto" />
<meta property="og:description" content="Blog Post Publish Date: 2023/11/19 This blog post covers an smart alternative to customize systemd unit process parameters. This blog post delivers a explanation of the systemd override.conf file. ..." />
<meta property="og:image:width" content="1146" />
<meta property="og:image:height" content="600" />
<meta property="og:image" content="https://carlosneto.dev/_images/social_previews/summary_blog_2023_2023-11-19-systemd-override-parameters_52ae9bd1.png" />
<meta property="og:image:alt" content="Blog Post Publish Date: 2023/11/19 This blog post covers an smart alternative to customize systemd unit process parameters. This blog post delivers a explana..." />
<meta name="description" content="Blog Post Publish Date: 2023/11/19 This blog post covers an smart alternative to customize systemd unit process parameters. This blog post delivers a explanation of the systemd override.conf file. ..." />
<meta name="twitter:card" content="summary_large_image" />

    <title>Properties Overriding: A Smart Way to Customize Systemd Unit Properties &#8212; Carlos Neto</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-examples.css?v=e236af4b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=e869902c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../../_static/documentation_options.js?v=187304be"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/design-tabs.js?v=36754332"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'blog/2023/2023-11-19-systemd-override-parameters';</script>
    <link rel="icon" href="../../../_static/profile-color-circle-small.png"/>
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" />

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>

<link
  rel="alternate"
  type="application/atom+xml"
  href="../../../blog/atom.xml"
  title="Carlos Neto"
/>



  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search/"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this site..."
         aria-label="Search this site..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../../">
  
  
  
  
  
  
    <p class="title logo__title">Carlos Neto</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../">
                        Blog
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../whoami/">
                        whoami
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/c-neto" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/in/c-neto/" title="LinkedIn" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">LinkedIn</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://carlosneto.dev/blog/atom.xml" title="Blog RSS feed" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-solid fa-rss fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Blog RSS feed</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../">
                        Blog
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../../whoami/">
                        whoami
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/c-neto" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.linkedin.com/in/c-neto/" title="LinkedIn" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-linkedin fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">LinkedIn</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://carlosneto.dev/blog/atom.xml" title="Blog RSS feed" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-solid fa-rss fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Blog RSS feed</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article"></div>
              
              

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
<p><em><strong>Blog Post Publish Date:</strong> 2023/11/19</em></p>
<hr class="docutils" />
<section id="properties-overriding-a-smart-way-to-customize-systemd-unit-properties">
<h1>Properties Overriding: A Smart Way to Customize Systemd Unit Properties<a class="headerlink" href="#properties-overriding-a-smart-way-to-customize-systemd-unit-properties" title="Link to this heading">#</a></h1>
<p>This blog post covers an smart alternative to customize systemd unit process parameters.</p>
<p>This blog post delivers a explanation of the systemd <code class="docutils literal notranslate"><span class="pre">override.conf</span></code> file. It elucidates the drawbacks of directly altering unit service configurations, introduces the overriding approach as a solution, presents a practical, hands-on example, and culminates with my perspective on the effectiveness of this structural methodology.</p>
<section id="drawbacks-of-direct-unit-service-editing">
<h2>Drawbacks of Direct Unit Service Editing<a class="headerlink" href="#drawbacks-of-direct-unit-service-editing" title="Link to this heading">#</a></h2>
<p>At times, there’s a need to modify certain properties within a particular systemd unit service, such as adjusting the value of an environment variable to enhance debug levels for troubleshooting. Traditionally, this involves directly altering the unit service file. For instance, if you wish to modify properties of Docker, you’d edit <code class="docutils literal notranslate"><span class="pre">/etc/systemd/system/docker.service</span></code>, implement the changes, refresh systemd with <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">systemctl</span> <span class="pre">daemon-reload</span></code>, and then restart the Docker process using <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">systemctl</span> <span class="pre">restart</span> <span class="pre">docker</span></code>.</p>
<p>While this approach functions adequately, it introduces certain behaviors that may pose issues depending on your use case.</p>
<ul class="simple">
<li><p>Modifying default unit services elevates the risk of configuring settings incorrectly.</p></li>
<li><p>Custom changes can be challenging to discern if they lack proper comments.</p></li>
<li><p>Unit service files might be overridden based on the installation method. For instance, the unit service could be replaced according to package update definitions of a package manager like <a class="reference external" href="https://rpm.org/">rpm</a> or <a class="reference external" href="https://wiki.debian.org/Apt">apt</a>.</p></li>
</ul>
<p>In the following section, I will elucidate an elegant workaround for these behaviors.</p>
</section>
<section id="the-solution-parameters-overriding">
<h2>The Solution: Parameters Overriding<a class="headerlink" href="#the-solution-parameters-overriding" title="Link to this heading">#</a></h2>
<p>A sophisticated approach to customizing unit service parameters involves overriding them.</p>
<p>This method enables you to make changes to systemd unit properties while preserving the default file without any modifications. This is possible because the method reads custom properties from another file and merges them with the default properties.</p>
<p>Override parameters are declared in the following file pattern:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span><span class="o">/&lt;</span><span class="n">UNIT</span><span class="o">-</span><span class="n">SERVICE</span><span class="o">-</span><span class="n">NAME</span><span class="o">&gt;.</span><span class="n">service</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">override</span><span class="o">.</span><span class="n">conf</span>
</pre></div>
</div>
<blockquote>
<div><p><em><code class="docutils literal notranslate"><span class="pre">&lt;UNIT-SERVICE-NAME&gt;</span></code> is a placeholder.</em></p>
</div></blockquote>
<p>All unit service properties defined in <code class="docutils literal notranslate"><span class="pre">override.conf</span></code> will take precedence over those defined in <code class="docutils literal notranslate"><span class="pre">&lt;UNIT-SERVICE-NAME&gt;.service</span></code>.</p>
<p>Consider the following example, where both default and override unit properties are illustrated.</p>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row docutils">
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm docutils">
<div class="sd-card-body docutils">
<ul class="simple">
<li><p class="sd-card-text"><strong>Default Properties</strong></p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">/etc/systemd/system/my-script.service</span><a class="headerlink" href="#id1" title="Link to this code">#</a></div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="p">...</span>
<span class="k">[Description]</span>
<span class="c1"># collapsed parameters...</span>

<span class="k">[Service]</span>
<span class="n">ExecStart</span><span class="o">=</span><span class="err">my-script.sh --prod</span>

<span class="k">[Install]</span>
<span class="c1"># collapsed parameters...</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm docutils">
<div class="sd-card-body docutils">
<ul class="simple">
<li><p class="sd-card-text"><strong>Override Properties</strong></p></li>
</ul>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">/etc/systemd/system/my-script.service.d/override.conf</span><a class="headerlink" href="#id2" title="Link to this code">#</a></div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[Service]</span>
<span class="n">ExecStart</span><span class="o">=</span><span class="err">my-script.sh --dev</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>When the <code class="docutils literal notranslate"><span class="pre">my-script.service</span></code> be executed, the <em>ExecStart</em> command will be <code class="docutils literal notranslate"><span class="pre">my-script.sh</span> <span class="pre">--dev</span></code> because it were declared in the <code class="docutils literal notranslate"><span class="pre">override.conf</span></code> that replace the <em>ExecStart</em> defined in the <code class="docutils literal notranslate"><span class="pre">my-script.service</span></code>.</p>
<hr class="docutils" />
<p>An efficient shortcut to execute this action is through the <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">systemctl</span> <span class="pre">edit</span> <span class="pre">&lt;UNIT-SERVICE-NAME&gt;</span></code> command.</p>
<p>This command creates a directory and file at <code class="docutils literal notranslate"><span class="pre">/etc/systemd/system/&lt;UNIT-SERVICE-NAME&gt;.service.d/override.conf</span></code>, opens your text editor for making the necessary changes, and upon closing it, automatically executes <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">systemctl</span> <span class="pre">daemon-reload</span></code> behind the scenes. The only additional step is to execute <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">systemctl</span> <span class="pre">restart</span> <span class="pre">&lt;UNIT-SERVICE-NAME&gt;</span></code> when necessary to apply the changes.</p>
</section>
<section id="hands-on">
<h2>Hands-On<a class="headerlink" href="#hands-on" title="Link to this heading">#</a></h2>
<p>Let’s get hands-on! This section will delve into a detailed example of the override method.</p>
<p>We will create a systemd unit service named <code class="docutils literal notranslate"><span class="pre">my-script</span></code>. To achieve this, we need to create the following files:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>/tmp/my-script/env_custom.env<span class="w">           </span><span class="c1"># env vars source of the my-script process</span>
/tmp/my-script/env_default.env<span class="w">          </span><span class="c1"># other env vars source of the my-script process</span>
/tmp/my-script/my-script.sh<span class="w">             </span><span class="c1"># script that my-script process run</span>
/etc/systemd/system/my-script.service<span class="w">   </span><span class="c1"># unit service file definition</span>
</pre></div>
</div>
<blockquote>
<div><p><em><i class="fa-solid fa-link"></i> The files can be found on my GitHub: <i class="fa-brands fa-github"></i> <a class="reference external" href="https://github.com/c-neto/my-devops-labs/tree/main/blog/2023-11-19/">c-neto/my-devops-labs/blog/2023-11-19</a></em></p>
</div></blockquote>
<p>Initially, let’s create the working directory for the script.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>mkdir<span class="w"> </span>/tmp/my-script/
</pre></div>
</div>
<p>Following that, we’ll generate the source code for the script.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">$ vim /tmp/my-script/my-script.sh</span><a class="headerlink" href="#id3" title="Link to this code">#</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="k">while</span><span class="w"> </span>true<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;&gt;&gt;&gt; </span><span class="nv">$APP_NAME</span><span class="s2"> - </span><span class="nv">$MY_CUSTOM_ENV_VAR</span><span class="s2">&quot;</span>
<span class="w">  </span>sleep<span class="w"> </span><span class="m">1</span>
<span class="k">done</span>
</pre></div>
</div>
</div>
<p>Assign the source code to the execution file parameter.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>chmod<span class="w"> </span>+x<span class="w"> </span>/tmp/my-script/my-script.sh
</pre></div>
</div>
<p>We will create two files that will serve as the source for environment variables in the <code class="docutils literal notranslate"><span class="pre">my-script</span></code> unit service.</p>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row docutils">
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm docutils">
<div class="sd-card-body docutils">
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">$ vim /tmp/my-script/env_default.env</span><a class="headerlink" href="#id4" title="Link to this code">#</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">APP_NAME</span><span class="o">=</span><span class="s2">&quot;My Awesome Script&quot;</span>
<span class="nv">MY_CUSTOM_ENV_VAR</span><span class="o">=</span><span class="s2">&quot;Irish Blood&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm docutils">
<div class="sd-card-body docutils">
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">$ vim /tmp/my-script/env_custom.env</span><a class="headerlink" href="#id5" title="Link to this code">#</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">MY_CUSTOM_ENV_VAR</span><span class="o">=</span><span class="s2">&quot;English Heart&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<p>Next, we will create the systemd unit service file.</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">$ vim /etc/systemd/system/my-script.service</span><a class="headerlink" href="#id6" title="Link to this code">#</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>Service<span class="o">]</span>
<span class="nv">WorkingDirectory</span><span class="o">=</span>/tmp/my-script/
<span class="nv">ExecStart</span><span class="o">=</span>my-script.sh
<span class="nv">EnvironmentFile</span><span class="o">=</span>/tmp/my-script/env_default.env

<span class="o">[</span>Install<span class="o">]</span>
<span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
</pre></div>
</div>
</div>
<p>Now, let’s reload the systemd daemon so that <code class="docutils literal notranslate"><span class="pre">my-script</span></code> can be managed as a service by systemd, and then start it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ systemctl daemon-reload
$ systemctl start my-script
</pre></div>
</div>
<p>To inspect the log of <code class="docutils literal notranslate"><span class="pre">my-script</span></code>, you can verify the value of the <code class="docutils literal notranslate"><span class="pre">/tmp/my-script/env_default.env</span></code> file.</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">$ journalctl -u my-script -f</span><a class="headerlink" href="#id7" title="Link to this code">#</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Nov<span class="w"> </span><span class="m">19</span><span class="w"> </span><span class="m">16</span>:11:29<span class="w"> </span>fedora<span class="w"> </span>my-script.sh<span class="o">[</span><span class="m">33631</span><span class="o">]</span>:<span class="w"> </span>&gt;&gt;&gt;<span class="w"> </span>My<span class="w"> </span>Awesome<span class="w"> </span>Script<span class="w"> </span>-<span class="w"> </span>Irish<span class="w"> </span>Blood
Nov<span class="w"> </span><span class="m">19</span><span class="w"> </span><span class="m">16</span>:11:30<span class="w"> </span>fedora<span class="w"> </span>my-script.sh<span class="o">[</span><span class="m">33631</span><span class="o">]</span>:<span class="w"> </span>&gt;&gt;&gt;<span class="w"> </span>My<span class="w"> </span>Awesome<span class="w"> </span>Script<span class="w"> </span>-<span class="w"> </span>Irish<span class="w"> </span>Blood
</pre></div>
</div>
</div>
<p>Next, we will override the source file for environment variables.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ mkdir /etc/systemd/system/my-script.service.d/
</pre></div>
</div>
<p>We will override the <code class="docutils literal notranslate"><span class="pre">EnvironmentFile</span></code> parameter.</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">$ vim /etc/systemd/system/my-script.service.d/override.conf</span><a class="headerlink" href="#id8" title="Link to this code">#</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>Service<span class="o">]</span>
<span class="nv">EnvironmentFile</span><span class="o">=</span>/tmp/my-script/env_custom.env
</pre></div>
</div>
</div>
<p>This time, variables from the <code class="docutils literal notranslate"><span class="pre">env_custom.env</span></code> file will replace those present in the <code class="docutils literal notranslate"><span class="pre">env_default.env</span></code> file.</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">$ journalctl -u my-script -f</span><a class="headerlink" href="#id9" title="Link to this code">#</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Nov<span class="w"> </span><span class="m">19</span><span class="w"> </span><span class="m">16</span>:21:42<span class="w"> </span>fedora<span class="w"> </span>my-script.sh<span class="o">[</span><span class="m">58573</span><span class="o">]</span>:<span class="w"> </span>&gt;&gt;&gt;<span class="w"> </span>My<span class="w"> </span>Awesome<span class="w"> </span>Script<span class="w"> </span>-<span class="w"> </span>English<span class="w"> </span>Heart
Nov<span class="w"> </span><span class="m">19</span><span class="w"> </span><span class="m">16</span>:21:43<span class="w"> </span>fedora<span class="w"> </span>my-script.sh<span class="o">[</span><span class="m">58573</span><span class="o">]</span>:<span class="w"> </span>&gt;&gt;&gt;<span class="w"> </span>My<span class="w"> </span>Awesome<span class="w"> </span>Script<span class="w"> </span>-<span class="w"> </span>English<span class="w"> </span>Heart
</pre></div>
</div>
</div>
</section>
<section id="conclusion-author-opinion">
<h2>Conclusion (Author Opinion)<a class="headerlink" href="#conclusion-author-opinion" title="Link to this heading">#</a></h2>
<p>In conclusion, leveraging systemd override parameters emerges as an invaluable tool in proactively addressing and preventing recurring issues. By preserving the integrity of the original unit service file while explicitly specifying custom parameters, this method significantly enhances troubleshooting capabilities. Another notable advantage lies in safeguarding against the loss of custom configurations that may be tied to the installation manager used to create a unit service (dnf, apt, brew).</p>
<p>The seamless flexibility provided by the <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">systemctl</span> <span class="pre">edit</span></code> command empowers users to swiftly and efficiently modify process properties, ensuring an agile and responsive approach to system management. In essence, incorporating systemd override parameters not only fortifies system stability but also streamlines the process of adapting and optimizing configurations to meet evolving needs. As a dynamic solution in the realm of systemd, it stands as an essential practice for maintaining a resilient and adaptable system environment.</p>
</section>
<section id="links">
<h2>Links<a class="headerlink" href="#links" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="github reference external" href="https://github.com/c-neto/my-devops-labs/tree/main/blog/2023-11-19/">c-neto/my-devops-labs</a></p></li>
<li><p><a class="reference external" href="https://systemd.io/">https://systemd.io/</a></p></li>
<li><p><a class="reference external" href="https://access.redhat.com/sites/default/files/attachments/12052018_systemd_6.pdf">https://access.redhat.com/sites/default/files/attachments/12052018_systemd_6.pdf</a></p></li>
</ul>
</section>
</section>

<div class="section ablog__blog_comments">
  
  


<div class="section ablog__prev-next">
  <span class="ablog__prev">
    
    
    <a href="../2023-11-02-logstash-modular-pipelines/">
      
      <i class="fa fa-arrow-circle-left"></i>
      
      <span>Logstash Modular Pipelines: An Elegant Structure for Code Reusability and Duplication Avoiding</span>
    </a>
    
  </span>
  <span class="ablog__spacer">&nbsp;</span>
  <span class="ablog__next">
    
    
    <a href="../../2024/2024-02-08-starship-zsh/">
      <span>ZSH + Starship: A Productivity Masterpiece</span>
      
      <i class="fa fa-arrow-circle-right" ></i>
      
    </a>
    
  </span>
</div>

  
  
</div>

                </article>
              
<!-- Add a comment box underneath the page's content -->
<script 
  src="https://giscus.app/client.js"
  data-repo="c-neto/carlosneto.dev"
  data-repo-id="R_kgDOKgwGNA"
  data-category="General"
  data-category-id="DIC_kwDOKgwGNM4CaKBI"
  data-mapping="pathname"
  data-strict="0"
  data-reactions-enabled="1"
  data-emit-metadata="0"
  data-input-position="bottom"
  data-theme="light"
  data-lang="en"
  crossorigin="anonymous"
  async>
</script>

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023, Carlos Neto.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.2.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>